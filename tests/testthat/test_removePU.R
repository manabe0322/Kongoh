test_that("removePU", {
  calOne <- matrix(0, 3, 4)
  rownames(calOne) <- c("peakOneL2", "sizeOneL2", "heightOneL2")
  calOne[1, ] <- c(11, 12, 13, 14)
  calOne[2, ] <- c(100, 104, 108, 112)
  calOne[3, ] <- c(200, 1000, 100, 1005)
  dyeOneL <- "B"
  gtOneL <- c(12, 14)
  alSize1 <- c(104, 112, 200)
  alDye1 <- c("B", "B", "G")
  calOneNew1 <- removePU(calOne, dyeOneL, alSize1, alDye1, gtOneL)
  alSize2 <- c(104, 112, 101)
  alDye2 <- c("B", "B", "G")
  calOneNew2 <- removePU(calOne, dyeOneL, alSize2, alDye2, gtOneL)
  alSize3 <- c(104, 112, 103)
  alDye3 <- c("B", "B", "G")
  calOneNew3 <- removePU(calOne, dyeOneL, alSize3, alDye3, gtOneL)
  alSize4 <- c(104, 112, 101, 109)
  alDye4 <- c("B", "B", "G", "G")
  calOneNew4 <- removePU(calOne, dyeOneL, alSize4, alDye4, gtOneL)

  expect_equal(ncol(calOneNew1), 4)
  expect_equal(ncol(calOneNew2), 3)
  expect_equal(as.numeric(calOneNew2[1, 1]), 12)
  expect_equal(as.numeric(calOneNew2[1, 2]), 13)
  expect_equal(as.numeric(calOneNew2[1, 3]), 14)
  expect_equal(as.numeric(calOneNew2[2, 1]), 104)
  expect_equal(as.numeric(calOneNew2[2, 2]), 108)
  expect_equal(as.numeric(calOneNew2[2, 3]), 112)
  expect_equal(as.numeric(calOneNew2[3, 1]), 1000)
  expect_equal(as.numeric(calOneNew2[3, 2]), 100)
  expect_equal(as.numeric(calOneNew2[3, 3]), 1005)
  expect_equal(ncol(calOneNew3), 4)
  expect_equal(ncol(calOneNew4), 2)
  expect_equal(as.numeric(calOneNew4[1, 1]), 12)
  expect_equal(as.numeric(calOneNew4[1, 2]), 14)
  expect_equal(as.numeric(calOneNew4[2, 1]), 104)
  expect_equal(as.numeric(calOneNew4[2, 2]), 112)
  expect_equal(as.numeric(calOneNew4[3, 1]), 1000)
  expect_equal(as.numeric(calOneNew4[3, 2]), 1005)
})
