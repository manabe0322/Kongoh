test_that("pickAlSize, mt = 30", {
  sampleL <- c("D3S1358", "AMEL", "D2S441", "D22S1045", "D10S1248")
  peakAllL <- sizeAllL <- heightAllL <- matrix("", 5, 20)
  peakAllL[1, ] <- c("OL", "OL", "OL", "OL", "12", "OL", "14", "15", "16", "17", "OL", "OL", "", "", "", "", "", NA, "", NA)
  peakAllL[2, ] <- c("X", "Y", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  peakAllL[3, ] <- c("9", "OL", "10", "11", "12", "OL", "16", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  peakAllL[4, ] <- c("10", "11", "12", "13", "14", "15", "16", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  peakAllL[5, ] <- c("11", "12", "13", "14", "15", "", "", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  sizeAllL[1, ] <- c("97.34", "98.63", "104.56", "106.03", "109.28", "114.16", "117.36", "121.37", "125.40", "129.40", "138.33", "146.66", NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[2, ] <- c("98.79", "104.89", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[3, ] <- c("80.79", "82.44", "84.97", "89.10", "93.25", "106.19", "109.20", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[4, ] <- c("94.45", "97.42", "100.41", "103.50", "106.52", "109.45", "112.46", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[5, ] <- c("97.99", "101.96", "106.11", "110.10", "114.16", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[1, ] <- c("18", "18", "20", "22", "18", "26", "42", "709", "10164", "50", "49", "27", NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[2, ] <- c("6814", "6947", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[3, ] <- c("250", "39", "5303", "4504", "27", "21", "21", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[4, ] <- c("113", "4383", "61", "20", "310", "4286", "172", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[5, ] <- c("28", "292", "4464", "396", "4899", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)

  mt_kitLoci <- rep(30, 5)
  names(mt_kitLoci) <- sampleL
  dye_kitLoci <- c("B", "G", "Y", "R", "P")
  names(dye_kitLoci) <- sampleL

  gtOne <- matrix("", 5, 4)
  gtOne[, 1] <- "Example"
  gtOne[, 2] <- sampleL
  gtOne[1, 3:4] <- c("16", "16")
  gtOne[2, 3:4] <- c("X", "Y")
  gtOne[3, 3:4] <- c("10", "11")
  gtOne[4, 3:4] <- c("11", "15")
  gtOne[5, 3:4] <- c("13", "15")
  colnames(gtOne) <- c("Sample.Name", "Marker", "Allele.1", "Allele.2")
  alSize <- pickAlSize(sampleL, peakAllL, sizeAllL, heightAllL, mt_kitLoci, dye_kitLoci, gtOne)

  expect_equal(ncol(alSize), 9)
  expect_equal(as.numeric(alSize[1, 1]), 125.40)
  expect_equal(as.numeric(alSize[1, 2]), 98.79)
  expect_equal(as.numeric(alSize[1, 3]), 104.89)
  expect_equal(as.numeric(alSize[1, 4]), 84.97)
  expect_equal(as.numeric(alSize[1, 5]), 89.10)
  expect_equal(as.numeric(alSize[1, 6]), 97.42)
  expect_equal(as.numeric(alSize[1, 7]), 109.45)
  expect_equal(as.numeric(alSize[1, 8]), 106.11)
  expect_equal(as.numeric(alSize[1, 9]), 114.16)
  expect_equal(alSize[2, 1], "B")
  expect_equal(alSize[2, 2], "G")
  expect_equal(alSize[2, 3], "G")
  expect_equal(alSize[2, 4], "Y")
  expect_equal(alSize[2, 5], "Y")
  expect_equal(alSize[2, 6], "R")
  expect_equal(alSize[2, 7], "R")
  expect_equal(alSize[2, 8], "P")
  expect_equal(alSize[2, 9], "P")
})

test_that("pickAlSize, mt = 4500", {
  sampleL <- c("D3S1358", "AMEL", "D2S441", "D22S1045", "D10S1248")
  peakAllL <- sizeAllL <- heightAllL <- matrix("", 5, 20)
  peakAllL[1, ] <- c("OL", "OL", "OL", "OL", "12", "OL", "14", "15", "16", "17", "OL", "OL", "", "", "", "", "", NA, "", NA)
  peakAllL[2, ] <- c("X", "Y", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  peakAllL[3, ] <- c("9", "OL", "10", "11", "12", "OL", "16", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  peakAllL[4, ] <- c("10", "11", "12", "13", "14", "15", "16", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  peakAllL[5, ] <- c("11", "12", "13", "14", "15", "", "", "", "", "", "", "", "", "", "", "", "", NA, "", NA)
  sizeAllL[1, ] <- c("97.34", "98.63", "104.56", "106.03", "109.28", "114.16", "117.36", "121.37", "125.40", "129.40", "138.33", "146.66", NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[2, ] <- c("98.79", "104.89", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[3, ] <- c("80.79", "82.44", "84.97", "89.10", "93.25", "106.19", "109.20", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[4, ] <- c("94.45", "97.42", "100.41", "103.50", "106.52", "109.45", "112.46", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  sizeAllL[5, ] <- c("97.99", "101.96", "106.11", "110.10", "114.16", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[1, ] <- c("18", "18", "20", "22", "18", "26", "42", "709", "10164", "50", "49", "27", NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[2, ] <- c("6814", "6947", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[3, ] <- c("250", "39", "5303", "4504", "27", "21", "21", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[4, ] <- c("113", "4383", "61", "20", "310", "4286", "172", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
  heightAllL[5, ] <- c("28", "292", "4464", "396", "4899", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)

  mt_kitLoci <- rep(4500, 5)
  names(mt_kitLoci) <- sampleL
  dye_kitLoci <- c("B", "G", "Y", "R", "P")
  names(dye_kitLoci) <- sampleL

  gtOne <- matrix("", 5, 4)
  gtOne[, 1] <- "Example"
  gtOne[, 2] <- sampleL
  gtOne[1, 3:4] <- c("16", "16")
  gtOne[2, 3:4] <- c("X", "Y")
  gtOne[3, 3:4] <- c("10", "11")
  gtOne[4, 3:4] <- c("11", "15")
  gtOne[5, 3:4] <- c("13", "15")
  colnames(gtOne) <- c("Sample.Name", "Marker", "Allele.1", "Allele.2")
  alSize <- pickAlSize(sampleL, peakAllL, sizeAllL, heightAllL, mt_kitLoci, dye_kitLoci, gtOne)

  expect_equal(ncol(alSize), 6)
  expect_equal(as.numeric(alSize[1, 1]), 125.40)
  expect_equal(as.numeric(alSize[1, 2]), 98.79)
  expect_equal(as.numeric(alSize[1, 3]), 104.89)
  expect_equal(as.numeric(alSize[1, 4]), 84.97)
  expect_equal(as.numeric(alSize[1, 5]), 89.10)
  expect_equal(as.numeric(alSize[1, 6]), 114.16)
  expect_equal(alSize[2, 1], "B")
  expect_equal(alSize[2, 2], "G")
  expect_equal(alSize[2, 3], "G")
  expect_equal(alSize[2, 4], "Y")
  expect_equal(alSize[2, 5], "Y")
  expect_equal(alSize[2, 6], "P")
})
