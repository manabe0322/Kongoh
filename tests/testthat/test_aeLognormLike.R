test_that("aeLognormLike", {
  #Example: GF D3

  par = c(1.12, 37.5)

  aeExample <- c(0.6509246, 1.7150368, 1.2554209, 1.1220615, 1.1505969, 1.1500599, 1.2530816, 0.9069865, 1.2671332, 1.2735708, 1.1096946, 0.3854632, 1.1838454, 1.0021294,
                 1.1789709, 1.0222307, 0.7420055, 1.2723353, 1.2156480, 1.1890379, 1.0366319, 1.1011276, 1.9852860, 1.2352941, 1.2334493, 0.8721799, 1.1390468, 0.9513747,
                 1.4426885, 0.7038159, 1.3012617, 1.1123751, 1.1090931, 1.1655814, 0.9986082, 1.1035642, 1.1480818, 1.0061254, 1.1337399, 1.1526384, 0.7416704, 1.3696265,
                 1.2575155, 1.0448831, 0.9903482, 1.0961929, 1.4166968, 1.0034632, 0.8892803, 1.1180610, 1.1768952, 1.0479140, 1.2545812, 1.2163798, 1.2739774, 1.0903873,
                 1.1092680, 1.1627600, 1.3816135, 1.2530742, 0.6976576, 1.1197268, 1.1781159, 1.1143791, 0.7120445, 1.0788954, 0.8078116, 0.8394056, 1.1477595, 1.0427466,
                 1.1008227, 1.1439815, 1.2168430, 1.2075993, 1.2941710, 1.2278375, 0.9795832, 1.1317467, 1.3796593, 1.2916952, 1.2329421, 1.3058002, 0.7007357, 1.3852479,
                 1.5251816, 1.0409333, 1.1956640, 1.1029099, 1.2489461, 0.9676797, 0.9223292, 0.9992901, 0.9313862, 1.0499713, 1.8130123, 0.9886756, 1.1573616, 0.8742791,
                 1.0818862, 1.1448590, 1.4708900, 1.0929108, 1.3507082, 1.1995038, 1.1754896, 1.1427387, 0.9967267, 0.7164160, 1.2138007, 1.0530626, 1.1425780, 1.1823174,
                 1.0703947, 1.0056048, 1.1131905, 1.2239694, 1.0644806, 1.0426587, 3.0323404, 0.9713269, 1.0610145, 1.1348521, 1.0580197, 1.1028560, 0.8791532, 1.3649331,
                 1.1999273, 1.1714589, 1.0384522, 1.0502108, 0.9237468, 1.1081185, 1.2717426, 1.2143642, 1.1771375, 1.0033573, 0.8600608, 1.3527117, 0.8883630, 1.2534857,
                 0.9762221, 0.9636924, 0.4697872, 0.9066479, 1.1474501, 1.3020634, 1.1089355, 1.0497347, 1.3658370, 1.0871675, 1.1136758, 1.2887444, 1.1639558, 1.1230222,
                 0.8614932, 0.9304655, 1.3620049, 0.9623674, 1.0581770, 0.8967109, 1.0362188, 0.9793283, 1.2946120, 1.0737093, 1.1893671, 1.3113014, 1.4272371, 0.8040926,
                 1.3044479, 1.1558903, 1.3426562, 2.0323303, 1.3480169, 0.8319922, 1.1554561, 1.0494066, 1.1276301, 0.5182118, 0.8593626, 1.3723765, 0.9389799, 1.1711473,
                 1.1348344, 0.6726248, 1.3957704, 1.2914371, 1.0785888, 1.1089824, 1.2496774, 1.5735124, 1.0627243, 1.1835151, 1.0910246, 0.9545796, 1.0448372, 1.0813886,
                 0.5827175, 0.9752457, 1.1727388, 1.1954384, 1.0691873, 1.0606232, 1.0306206, 1.3676466, 1.1062392, 1.1414895, 1.2661559, 1.6522740, 1.0054059, 1.0758835,
                 1.1144138, 1.1793917, 1.7298516, 1.0351484, 1.3482582, 1.0565111, 1.0534201, 1.0228783, 1.4512559, 0.9428387, 0.8605566, 1.0166329, 1.0363462, 1.0972480,
                 1.0063425, 0.9470810, 0.7884930, 1.1474650, 1.0219421, 0.9933358, 0.9140069, 0.6204545, 0.9498853, 1.1429732, 1.0830085, 1.0578549, 1.2741827, 1.1742506,
                 1.3326296, 0.9664317, 1.2827282, 1.0720942, 0.9586268, 1.9350377, 0.6358657, 0.9976512, 1.0873381, 1.0910187, 0.4694422, 1.2667255, 0.9954418, 0.9476244,
                 1.0970714, 1.1605888, 0.3810107, 0.7334918, 1.4366125, 1.0391152, 1.2938281, 1.2007070, 0.9753052, 1.1439515, 1.2365196, 0.9046092, 1.2602687, 1.2229023,
                 1.0984135, 1.2523936, 0.8674562, 0.9603674, 1.0076167, 1.0214767, 0.6123553, 0.8323213, 1.7063002, 0.9913661, 0.9689260, 1.0950035, 0.7881470, 1.2998684,
                 1.1911078, 0.7869106, 1.0302757, 1.2045770, 0.9199201, 1.7302031, 0.7729986, 1.1233249, 0.9805147, 1.0777721, 1.5195592, 1.0213740, 1.2010008, 1.3686834,
                 1.2092256, 1.0929125)

  aeHeightExample <- c(116.5, 699.0, 981.5, 1861.5, 3671.5, 5482.5, 532.5, 771.5, 2121.0, 4918.5, 7005.0, 236.5, 1462.5, 1994.5, 5624.0, 7539.0, 179.0, 787.0,
                       1334.0, 2690.0, 4375.5, 8310.0, 514.0, 612.0, 1435.5, 1701.0, 4785.0, 8940.0, 369.5, 249.0, 1161.5, 2358.5, 4298.0, 8323.5, 205.0, 547.0,
                       1160.0, 1951.5, 5369.5, 9554.0, 159.0, 485.5, 865.5, 2016.5, 4932.5, 7827.0, 280.0, 545.0, 835.5, 2133.5, 4596.0, 8439.5, 319.5, 244.0,
                       1544.0, 2307.0, 4803.5, 10136.0, 263.0, 526.5, 690.0, 2595.5, 5033.5, 8377.0, 167.5, 533.0, 651.0, 1864.0, 5296.5, 8507.0, 274.0, 529.5,
                       1270.5, 2874.0, 4958.0, 7235.5, 164.5, 334.0, 983.5, 2968.5, 4301.5, 7455.0, 127.0, 541.5, 1525.0, 2101.0, 4026.0, 6031.0, 261.0, 465.5,
                       928.5, 2111.5, 3848.0, 7318.0, 416.0, 409.5, 1036.5, 2173.0, 4002.0, 7357.0, 314.0, 468.0, 1028.5, 2210.0, 4348.5, 7283.0, 232.0, 393.5,
                       923.5, 2278.0, 4900.0, 7428.5, 206.0, 440.0, 879.5, 2266.5, 3800.5, 6622.0, 509.0, 331.5, 879.0, 2059.0, 3644.5, 5932.0, 220.5, 663.0,
                       1179.5, 2573.5, 4267.0, 8096.0, 197.0, 480.0, 1135.0, 3314.0, 5518.0, 7592.5, 195.5, 677.0, 728.5, 2590.0, 4218.0, 7272.0, 92.0, 490.0,
                       1035.0, 3080.0, 4609.0, 5837.0, 665.0, 1141.5, 2034.5, 5030.0, 7251.5, 218.0, 341.5, 858.0, 2716.0, 4809.5, 9042.5, 185.0, 492.5, 1040.0,
                       3297.5, 4664.5, 8597.0, 273.5, 789.5, 893.5, 2308.5, 6102.0, 9675.5, 453.5, 570.5, 933.0, 2685.5, 3846.5, 9386.5, 146.0, 517.5, 1533.5,
                       2614.5, 5852.0, 9588.0, 133.5, 770.0, 1278.0, 2050.5, 5422.0, 9176.5, 357.0, 486.5, 1100.5, 2577.0, 4447.0, 9026.0, 400.5, 368.0, 1120.0,
                       2977.5, 6664.0, 9076.0, 626.5, 1166.0, 3479.0, 5070.5, 10686.0, 271.5, 820.0, 863.5, 2640.5, 4474.0, 8792.0, 347.0, 463.5, 862.5, 1326.5,
                       2518.0, 4463.5, 243.5, 313.0, 640.5, 1529.5, 4565.5, 6762.0, 136.0, 334.5, 804.0, 1774.5, 3568.5, 6927.5, 165.0, 266.5, 769.0, 1943.0,
                       3155.5, 4919.0, 225.5, 464.5, 1022.0, 1482.0, 3568.0, 6828.5, 181.5, 769.5, 696.5, 2012.5, 3861.5, 8207.5, 109.0, 751.5, 1367.5, 2004.0,
                       4423.0, 8508.0, 81.5, 338.0, 1811.5, 1978.5, 4863.5, 6963.5, 165.5, 512.0, 920.0, 1578.5, 5254.0, 6835.5, 211.0, 517.0, 929.5, 1859.5,
                       4510.5, 6191.0, 97.0, 303.5, 1487.0, 1654.0, 3203.5, 6333.5, 167.5, 447.0, 1129.0, 1418.5, 3887.5, 6790.0, 142.5, 604.5, 632.0, 1928.0,
                       2159.0, 4475.5, 197.0, 334.5, 1011.5, 1687.0, 3509.0, 4690.0)

  minAE <- 0.058

  like <- aeLognormLike(par, aeExample, aeHeightExample, minAE)
  expect_equal(round(like, 4), -118.4089)

  aic <- calcAIC(-like, 2)
  expect_equal(round(aic, 0), -233)
})
