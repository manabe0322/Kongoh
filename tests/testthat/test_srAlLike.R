test_that("srAlLike", {
  #Example: GF D3

  par <- c(0.00641, -0.0271, 27.3)

  bsrExample <- c(0.09561129, 0.07033806, 0.09098966, 0.08878224, 0.06975600, 0.06007067,
                  0.05864811, 0.06267218, 0.07406465, 0.06728361, 0.06866723, 0.06075949,
                  0.07909605, 0.05544933, 0.06565657, 0.06535471, 0.06654295, 0.07894737,
                  0.09654472, 0.08971348, 0.06573541, 0.06939144, 0.07571372, 0.05298013,
                  0.05888768, 0.06261510, 0.06243414, 0.06956995, 0.07122253, 0.05660377,
                  0.06759443, 0.06418485, 0.06339263, 0.06732789, 0.07295863, 0.06146179,
                  0.06681514, 0.07261663, 0.07296539, 0.06764304, 0.07868020, 0.11244378,
                  0.06984479, 0.08701657, 0.08138150, 0.07260726, 0.07703081, 0.07134146,
                  0.07453974, 0.09847634, 0.07231041, 0.11153846, 0.07124682, 0.06965944,
                  0.07194873, 0.08272093, 0.09141274, 0.07623318, 0.07176582, 0.07512275,
                  0.07240705, 0.07782883, 0.05962060, 0.06362922, 0.06661786, 0.07952161,
                  0.07300488, 0.07347456, 0.13580247, 0.06637650, 0.06976744, 0.07952146,
                  0.07596717, 0.07574912, 0.06282723, 0.07518189, 0.06136681, 0.06510895,
                  0.06814055, 0.06753748, 0.07692308, 0.08191126, 0.07895664, 0.08007261,
                  0.09021423, 0.09652510, 0.06120219, 0.07461538, 0.07277290, 0.07584990,
                  0.06948944, 0.06374502, 0.06648199, 0.06007509, 0.07159655, 0.07562688,
                  0.07811113, 0.07951482, 0.06821480, 0.06921241, 0.05964286, 0.06838637,
                  0.07210143, 0.14090909, 0.06341463, 0.05087440, 0.05777778, 0.06349206,
                  0.07288520, 0.08910891, 0.06326531, 0.06045865, 0.06937535, 0.06786869,
                  0.06997817, 0.05204461, 0.07414449, 0.05916399, 0.06934897, 0.07279578,
                  0.09813084, 0.07321773, 0.08571429, 0.06865805, 0.06990418, 0.06045865,
                  0.07188161, 0.07280514, 0.06303940, 0.06845188)

  bsrAlExample <- c(16, 16, 16, 16, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 15,
                    15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 17, 17, 17, 17, 17, 17, 17,
                    17, 17, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16,
                    16, 16, 15, 15, 15, 15, 15, 15, 18, 18, 18, 18, 18, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16,
                    16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15,
                    15, 15, 15, 15, 15, 15, 15, 15, 15, 15)

  bsrHeightExample <- c(1398, 1963, 3723, 7343, 10965, 600, 1065, 1543, 4242, 9837, 14010, 419,
                        191, 1104, 2954, 4401, 8068, 410, 1094, 2320, 3903, 10739, 19108, 318,
                        971, 1731, 4033, 9865, 15654, 560, 1090, 1671, 4267, 9192, 16879, 639,
                        1437, 2644, 5735, 8602, 425, 742, 1930, 3958, 5495, 325, 769, 1757,
                        4811, 6888, 608, 289, 842, 2073, 3694, 5774, 394, 960, 2270, 6628,
                        11036, 15185, 391, 1354, 1457, 5180, 8436, 14544, 184, 980, 2070, 6160,
                        9218, 11674, 406, 1330, 2283, 4069, 10060, 14503, 266, 951, 3076, 5387,
                        10168, 284, 971, 1397, 2565, 6709, 9573, 267, 1540, 2556, 4101, 10844,
                        18353, 801, 736, 2240, 5955, 13328, 18152, 251, 872, 661, 2856, 4221,
                        8523, 330, 533, 1538, 3886, 6311, 9838, 566, 565, 1647, 5307, 7140,
                        235, 557, 684, 2397, 4913, 6104, 1014, 1503, 2833, 6384)

  maxBSR <- 0.7

  like <- srAlLike(par, bsrExample, bsrAlExample, bsrHeightExample, maxBSR)
  expect_equal(round(like, 4), -104.0305)

  aic <- calcAIC(-like, 3)
  expect_equal(round(aic, 0), -202)
})
