test_that("srUniformLike", {
  #Example GF SE33

  par <- c(0.0267, 122)

  m2srExample <- c(0.02556391, 0.03493976, 0.03536693, 0.03945111, 0.03542062, 0.02649199,
                   0.02305722, 0.02744962, 0.02417140, 0.03793103, 0.01900000, 0.02366440,
                   0.02575844, 0.02249389, 0.02041694, 0.02877071, 0.02264946, 0.04835165,
                   0.02491103, 0.02332980, 0.02490842, 0.07111597, 0.02490775, 0.02452698,
                   0.02715655, 0.02975637, 0.02721170, 0.02702397, 0.01985112, 0.02177419,
                   0.01986755, 0.03121998, 0.02585093, 0.02081144, 0.02664645, 0.03197070,
                   0.02664298, 0.02853881, 0.02984783, 0.02030205, 0.03234256, 0.02662661,
                   0.02884013, 0.02808187, 0.02488100, 0.02535390, 0.02822952, 0.04761905,
                   0.02917264, 0.02501117, 0.02388004, 0.02695857, 0.02764210, 0.02321501,
                   0.11666667, 0.05272408, 0.04308548, 0.01626016, 0.02154951, 0.03417328,
                   0.03251207, 0.02583917, 0.03039913, 0.02608048, 0.02539062, 0.02943018,
                   0.02257024, 0.02524358, 0.02524369, 0.02687910, 0.02774229, 0.06627907,
                   0.02724177, 0.02601810, 0.02952192, 0.02703312, 0.02726584, 0.02343518,
                   0.03631647, 0.04272363, 0.02287893, 0.02400000, 0.02731183, 0.03135997,
                   0.03107471, 0.01585728, 0.02218935, 0.02641335, 0.02605549, 0.02218966,
                   0.02613176, 0.02596228, 0.03663004, 0.02160494, 0.02358700, 0.02199074,
                   0.02166793, 0.02210492, 0.02304965, 0.02581407, 0.03021148, 0.02338957,
                   0.02214629, 0.02359569, 0.11111111, 0.03664921, 0.02377622, 0.02890173,
                   0.03404018, 0.02615012, 0.02391629, 0.02884615, 0.03100992, 0.02442571,
                   0.02841678, 0.02576809, 0.02627014, 0.02275219, 0.02626932, 0.02611828,
                   0.02866987, 0.02410403, 0.02861035, 0.04030227, 0.02825553, 0.01375894,
                   0.03468573, 0.03270703, 0.03317536, 0.02385510, 0.07407407, 0.03494176,
                   0.02744630, 0.02070207, 0.02928673, 0.03176796, 0.02199145, 0.02756931,
                   0.02292401, 0.05198777, 0.02992519, 0.03532220, 0.04225352, 0.02005731,
                   0.02269146, 0.03296703, 0.02438143, 0.04651163, 0.02779810, 0.03850345,
                   0.02837838, 0.02295009, 0.02484167, 0.04639175, 0.04575163, 0.02851524,
                   0.03624161, 0.02682234, 0.03186538, 0.03110002, 0.03188895, 0.02990218,
                   0.02892508, 0.05927835, 0.01927711, 0.03070761, 0.03258427, 0.02897694,
                   0.02699558, 0.02529960, 0.02643573, 0.03035714, 0.02425876, 0.02167766,
                   0.02678293, 0.04351636, 0.03375211, 0.02880335, 0.02878878, 0.02608557,
                   0.03161398, 0.02329594, 0.01642710, 0.02256637, 0.01844046, 0.03132251,
                   0.02859936, 0.03014509, 0.02936678, 0.04291287, 0.02175602, 0.01975541,
                   0.02439024, 0.02211596, 0.02770936, 0.02035369, 0.02802328, 0.02731737,
                   0.08670520, 0.09318182, 0.03534031, 0.02516309, 0.02843602, 0.01883408,
                   0.02773775, 0.02929936, 0.02262181, 0.02948403, 0.02760536, 0.05327245,
                   0.02500000, 0.02292921, 0.02896282, 0.02323634, 0.02793834, 0.02679946,
                   0.02281537, 0.04024768, 0.04534005, 0.02304147, 0.02296651, 0.02358974,
                   0.01965318, 0.02566940, 0.03027740, 0.02875160, 0.02605981, 0.05248619,
                   0.08365019, 0.02641509, 0.03586801, 0.02422907, 0.02772116, 0.02634352,
                   0.02786945, 0.02680478, 0.02563630, 0.02270270, 0.05674518, 0.02564802,
                   0.02250804, 0.02674436, 0.02402728, 0.03095906, 0.02506203, 0.03929273,
                   0.04334038, 0.02764128, 0.01500441, 0.02333588, 0.03252033, 0.02942682,
                   0.02330913, 0.02756086, 0.02342079, 0.09830508, 0.02810304, 0.02004219,
                   0.02795341, 0.02666667, 0.03243243, 0.02543570, 0.02230634, 0.02057390,
                   0.03769401, 0.02470930, 0.02209945, 0.03047619, 0.03464203, 0.03567134,
                   0.02414033, 0.02436939, 0.02414773, 0.02802283, 0.02421684, 0.02664360,
                   0.02948856, 0.01973684, 0.02474227, 0.02515877, 0.02376600, 0.02245389,
                   0.04885655, 0.02014463, 0.02618495, 0.02519733, 0.02587859, 0.02681209,
                   0.03453947, 0.02601865, 0.02903600, 0.02496100, 0.01819505, 0.02629573,
                   0.02069841, 0.05800000, 0.04911323, 0.02098467, 0.02702703, 0.02674524,
                   0.02293152, 0.02412810, 0.02397661, 0.02924051, 0.02482425, 0.04301075,
                   0.02773860, 0.03505727, 0.02563007, 0.02851324, 0.02638813, 0.03433750,
                   0.02987914, 0.02355316, 0.02127660, 0.02793017, 0.01971831, 0.02801184,
                   0.02627311, 0.03089431, 0.01987745, 0.02430556, 0.03500583, 0.02297090,
                   0.02006173, 0.02256561, 0.01825029, 0.02663602, 0.02394775, 0.07011070,
                   0.03142857, 0.02786070, 0.02363445, 0.02901786, 0.03015682, 0.02741514,
                   0.02484696, 0.02505695, 0.03050847, 0.02638665, 0.02750583, 0.02974290,
                   0.02763211, 0.04507338, 0.02925532, 0.02650897, 0.01945946, 0.02848101,
                   0.01992389, 0.02541581)

  m2srHeightExample <- c(750, 924, 1340, 1928, 1774, 3781, 3958, 6345, 6281, 981, 1092, 3055,
                         1968, 4482, 5147, 6380, 8675, 543, 921, 1023, 1472, 1078, 2373, 3152,
                         6122, 5977, 9156, 9921, 906, 1407, 1163, 2419, 2566, 5380, 5162, 11533,
                         10081, 3036, 5336, 4594, 9150, 11007, 1829, 2365, 5212, 10681, 18656, 555,
                         2386, 2463, 6095, 6110, 10213, 8348, 230, 649, 1668, 1237, 2180, 3327,
                         4418, 4862, 10210, 1541, 1759, 1828, 2501, 5206, 4647, 9526, 12684, 984,
                         2920, 2009, 5140, 5076, 8897, 7919, 884, 2343, 2388, 6272, 5404, 10017,
                         10424, 1102, 3088, 2398, 4704, 5267, 6136, 8579, 611, 1096, 2491, 2905,
                         4365, 3558, 6263, 6659, 2674, 5875, 8850, 13808, 250, 846, 1598, 768,
                         1981, 2292, 4474, 4478, 8040, 7708, 796, 1096, 4448, 3980, 4943, 3640,
                         8968, 6917, 834, 1342, 1918, 2048, 5418, 4897, 7732, 7682, 341, 673,
                         937, 2442, 2468, 3274, 3696, 7433, 7042, 380, 901, 2448, 1432, 3884,
                         3654, 6660, 6435, 480, 1531, 3076, 4906, 10047, 18337, 434, 673, 1113,
                         772, 3576, 2939, 5808, 5534, 9892, 7970, 445, 922, 2510, 2074, 5719,
                         4995, 8556, 8732, 629, 1520, 1195, 3357, 3873, 5574, 4337, 6998, 7119,
                         620, 1186, 1076, 2311, 2112, 5410, 4572, 7378, 7285, 895, 1425, 1201,
                         2202, 1962, 5606, 6876, 10663, 11470, 420, 551, 975, 1188, 1449, 3699,
                         3285, 4383, 3993, 9672, 7202, 737, 1450, 3850, 2884, 5291, 4801, 12396,
                         10412, 740, 478, 1469, 1203, 4487, 2969, 5191, 6923, 10690, 9758, 381,
                         570, 1360, 1578, 2790, 2768, 5869, 6139, 9639, 12153, 1046, 1093, 3891,
                         3156, 6941, 7406, 9279, 9383, 564, 1085, 1795, 1256, 2895, 3028, 4350,
                         5876, 12241, 10136, 353, 955, 1085, 3312, 1551, 3786, 4835, 8246, 8426,
                         1022, 762, 1211, 1215, 3538, 2903, 6614, 5447, 1550, 4763, 5111, 7407,
                         7243, 1000, 1610, 4567, 7954, 1275, 2018, 2210, 3096, 3774, 6455, 5033,
                         679, 2278, 1975, 4322, 3121, 8846, 8938, 585, 821, 1357, 1448, 2449,
                         3702, 5061, 3760, 8894, 10119, 1875, 2339, 3245, 2549, 4379, 3972, 8860,
                         9809, 1644, 996, 2223, 1759, 4944, 3647, 6340, 7817, 1004, 982, 2880,
                         1442, 4556, 3894, 8262, 6213, 580, 1207, 3149, 2145, 4698, 5718, 6355,
                         6463, 2428, 2027, 4124, 2441, 6702, 5714, 1121, 819, 2771, 2033, 2505,
                         5107, 5935)

  maxM2SR <- 0.12

  like <- srUniformLike(par, m2srExample, m2srHeightExample, maxM2SR)
  expect_equal(round(like, 5), -61.5366)

  aic <- calcAIC(-like, 2)
  expect_equal(round(aic, 0), -119)
})
