test_that("hbLognormLike", {
  #Example: GF D3

  par = c(1.01, 198)

  hbExample <- c(0.7637232, 1.6073298, 1.1041667, 0.5968179, 0.9531925, 1.0633366, 1.7570621, 1.1489214, 0.7450832, 0.6751526, 1.3566612, 0.7278912, 0.6458967, 0.3214905,
                 0.8494718, 0.9743968, 0.8433088, 2.5968992, 1.4215385, 1.4018205, 1.5930563, 1.0369985, 1.1569396, 0.6743421, 1.2941176, 1.0878860, 0.9864930, 0.9731998,
                 1.0547281, 0.2823529, 0.6378897, 1.2431373, 1.3184741, 1.2856802, 1.3092969, 0.9260563, 0.6261586, 0.2791696, 0.8000000, 0.8190490, 1.0214144, 3.5625000,
                 1.1296296, 0.9838292, 0.7701422, 1.2091355, 0.9326749, 1.1633466, 0.8807339, 1.6127080, 0.8490896, 1.1198768, 1.0631233, 3.2987013, 0.8091873, 2.2566372,
                 0.9168185, 0.9800264, 0.9147059, 0.7957447, 0.8563734, 1.7178363, 0.5515227, 0.8361490, 1.0285059, 0.7195467, 1.9329389, 1.2009315, 1.2615602, 0.9841792)

  hbHeightExample <- c(369.5, 249.0, 1161.5, 2358.5, 4298.0, 8323.5, 244.0, 1544.0, 2307.0, 4803.5, 10136.0, 127.0, 541.5, 1525.0, 2101.0, 4026.0, 6031.0, 232.0,
                       393.5, 923.5, 2278.0, 4900.0, 7428.5, 509.0, 331.5, 879.0, 2059.0, 3644.5, 5932.0, 218.0, 341.5, 858.0, 2716.0, 4809.5, 9042.5, 273.5,
                       789.5, 893.5, 2308.5, 6102.0, 9675.5, 146.0, 517.5, 1533.5, 2614.5, 5852.0, 9588.0, 271.5, 820.0, 863.5, 2640.5, 4474.0, 8792.0, 165.5,
                       512.0, 920.0, 1578.5, 5254.0, 6835.5, 211.0, 517.0, 929.5, 1859.5, 4510.5, 6191.0, 303.5, 1487.0, 1654.0, 3203.5, 6333.5)

  minHb <- 0.046

  like <- hbLognormLike(par, hbExample, hbHeightExample, minHb)
  expect_equal(round(like, 5), 28.28922)

  aic <- calcAIC(-like, 2)
  expect_equal(round(aic, 1), 60.6)
})
